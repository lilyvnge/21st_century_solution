{% extends "base.html" %}

{% block title %}DNS Lookup Tool - 21STCENTURY SOLUTIONS{% endblock %}

{% block extra_css %}
<style>
    .dns-record {
        background: var(--color-dark-accent);
        padding: 1rem;
        margin: 0.5rem 0;
        border-radius: var(--radius-sm);
        border-left: 4px solid var(--color-accent);
    }
    
    .record-type {
        font-weight: bold;
        color: var(--color-accent);
    }
    
    .whois-info {
        background: var(--color-darker);
        padding: 1rem;
        border-radius: var(--radius-sm);
        margin: 1rem 0;
    }
</style>
{% endblock %}

{% block content %}
<section class="section">
    <div class="container">
        <div class="section-title">
            <h2>DNS <span class="text-accent">Lookup Tool</span></h2>
            <p>Comprehensive DNS record analysis and WHOIS information</p>
        </div>

        <div class="card">
            <form method="POST" action="/tools/dns_lookup">
                <div class="form-group">
                    <label for="domain" class="form-label">Domain Name</label>
                    <input type="text" class="form-input" id="domain" name="domain" 
                           placeholder="example.com" value="{{ domain or '' }}" required>
                </div>
                
                <div class="form-group">
                    <label for="record_type" class="form-label">Record Type</label>
                    <select class="form-input" id="record_type" name="record_type">
                        <option value="all" {% if record_type == 'all' %}selected{% endif %}>All Records</option>
                        <option value="A" {% if record_type == 'A' %}selected{% endif %}>A (IPv4 Address)</option>
                        <option value="AAAA" {% if record_type == 'AAAA' %}selected{% endif %}>AAAA (IPv6 Address)</option>
                        <option value="MX" {% if record_type == 'MX' %}selected{% endif %}>MX (Mail Exchange)</option>
                        <option value="TXT" {% if record_type == 'TXT' %}selected{% endif %}>TXT (Text Record)</option>
                        <option value="NS" {% if record_type == 'NS' %}selected{% endif %}>NS (Name Server)</option>
                    </select>
                </div>
                
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-search"></i> Lookup DNS Records
                </button>
            </form>
        </div>

        {% if results %}
        <div class="card mt-lg">
            <h3>DNS Lookup Results for <span class="text-accent">{{ domain }}</span></h3>
            
            {% for record_type, records in results.items() %}
                {% if record_type != 'WHOIS' %}
                <div class="dns-record">
                    <h4><span class="record-type">{{ record_type }}</span> Records</h4>
                    {% if records[0] != 'No records found' %}
                        <ul>
                            {% for record in records %}
                                <li><code>{{ record }}</code></li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <p style="color: var(--color-mid);">No {{ record_type }} records found</p>
                    {% endif %}
                </div>
                {% endif %}
            {% endfor %}

            {% if results.WHOIS and results.WHOIS.error != 'WHOIS information not available' %}
            <div class="whois-info">
                <h4>WHOIS Information</h4>
                <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                    <div>
                        <p><strong>Registrar:</strong> {{ results.WHOIS.registrar or 'Not available' }}</p>
                        <p><strong>Creation Date:</strong> {{ results.WHOIS.creation_date or 'Not available' }}</p>
                    </div>
                    <div>
                        <p><strong>Expiration Date:</strong> {{ results.WHOIS.expiration_date or 'Not available' }}</p>
                        <p><strong>Name Servers:</strong></p>
                        <ul>
                            {% if results.WHOIS.name_servers %}
                                {% for ns in results.WHOIS.name_servers %}
                                    <li>{{ ns }}</li>
                                {% endfor %}
                            {% else %}
                                <li>Not available</li>
                            {% endif %}
                        </ul>
                    </div>
                </div>
            </div>
            {% elif results.WHOIS.error %}
            <div class="whois-info">
                <h4>WHOIS Information</h4>
                <p style="color: var(--color-mid);">{{ results.WHOIS.error }}</p>
            </div>
            {% endif %}
        </div>
        {% endif %}

        <div class="card mt-lg">
            <h3>About DNS Records</h3>
            <p>DNS (Domain Name System) records are essential for directing internet traffic. Understanding these records helps in security analysis and troubleshooting.</p>
            
            <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1rem;">
                <div>
                    <h4>Common Record Types</h4>
                    <ul>
                        <li><strong>A:</strong> IPv4 address</li>
                        <li><strong>AAAA:</strong> IPv6 address</li>
                        <li><strong>MX:</strong> Mail server</li>
                        <li><strong>TXT:</strong> Text records</li>
                        <li><strong>NS:</strong> Name server</li>
                    </ul>
                </div>
                <div>
                    <h4>Security Implications</h4>
                    <ul>
                        <li>SPF/DKIM records prevent email spoofing</li>
                        <li>DNSSEC provides DNS data integrity</li>
                        <li>Proper NS records prevent hijacking</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}