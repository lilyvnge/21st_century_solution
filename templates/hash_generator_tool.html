{% extends "base.html" %}

{% block title %}Hash Generator - 21STCENTURY SOLUTIONS{% endblock %}

{% block extra_css %}
<style>
    .hash-result {
        background: var(--color-dark-accent);
        padding: 1rem;
        margin: 0.5rem 0;
        border-radius: var(--radius-sm);
        border-left: 4px solid var(--color-accent);
        position: relative;
    }
    
    .hash-value {
        font-family: monospace;
        word-break: break-all;
        margin: 0.5rem 0;
    }
    
    .copy-btn {
        position: absolute;
        top: 1rem;
        right: 1rem;
        background: var(--color-accent);
        color: white;
        border: none;
        padding: 0.3rem 0.6rem;
        border-radius: 3px;
        cursor: pointer;
        font-size: 0.8rem;
    }
    
    .copy-btn:hover {
        background: var(--color-accent-hover);
    }
    
    .algorithm-selector {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 0.5rem;
        margin: 1rem 0;
    }
    
    .algorithm-btn {
        padding: 0.5rem;
        background: var(--color-darker);
        border: 1px solid var(--color-mid);
        border-radius: var(--radius-sm);
        cursor: pointer;
        text-align: center;
    }
    
    .algorithm-btn.active {
        background: var(--color-accent);
        border-color: var(--color-accent);
    }
    
    .algorithm-btn:hover {
        border-color: var(--color-accent);
    }
</style>
{% endblock %}

{% block content %}
<section class="section">
    <div class="container">
        <div class="section-title">
            <h2>Hash <span class="text-accent">Generator</span></h2>
            <p>Generate cryptographic hashes instantly - all processing happens in your browser</p>
        </div>

        <div class="card">
            <div class="form-group">
                <label for="inputText" class="form-label">Text to Hash</label>
                <textarea class="form-input" id="inputText" name="inputText" 
                          placeholder="Enter text to generate hash" rows="4" style="resize: vertical;"></textarea>
                <small style="color: var(--color-mid);">Your data is processed locally and never sent to our servers</small>
            </div>

            <div class="algorithm-selector">
                <div class="algorithm-btn active" data-algorithm="md5">MD5</div>
                <div class="algorithm-btn" data-algorithm="sha1">SHA-1</div>
                <div class="algorithm-btn" data-algorithm="sha256">SHA-256</div>
                <div class="algorithm-btn" data-algorithm="sha512">SHA-512</div>
            </div>

            <div id="hashResults" style="display: none;">
                <h4>Generated Hashes</h4>
                <div id="md5-result" class="hash-result">
                    <h5>MD5 Hash</h5>
                    <div class="hash-value" id="md5-value"></div>
                    <button class="copy-btn" data-target="md5-value">Copy</button>
                </div>
                
                <div id="sha1-result" class="hash-result" style="display: none;">
                    <h5>SHA-1 Hash</h5>
                    <div class="hash-value" id="sha1-value"></div>
                    <button class="copy-btn" data-target="sha1-value">Copy</button>
                </div>
                
                <div id="sha256-result" class="hash-result" style="display: none;">
                    <h5>SHA-256 Hash</h5>
                    <div class="hash-value" id="sha256-value"></div>
                    <button class="copy-btn" data-target="sha256-value">Copy</button>
                </div>
                
                <div id="sha512-result" class="hash-result" style="display: none;">
                    <h5>SHA-512 Hash</h5>
                    <div class="hash-value" id="sha512-value"></div>
                    <button class="copy-btn" data-target="sha512-value">Copy</button>
                </div>
            </div>
        </div>

        <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin-top: 2rem;">
            <div class="card">
                <h3>About Cryptographic Hashes</h3>
                <p>Hash functions convert input data into fixed-size strings of characters. They're commonly used for:</p>
                <ul>
                    <li>Data integrity verification</li>
                    <li>Password storage</li>
                    <li>Digital signatures</li>
                    <li>Blockchain technology</li>
                </ul>
            </div>
            
            <div class="card">
                <h3>Hash Algorithm Security</h3>
                <ul>
                    <li><strong>MD5:</strong> Considered broken for security purposes</li>
                    <li><strong>SHA-1:</strong> Vulnerable to collision attacks</li>
                    <li><strong>SHA-256:</strong> Currently secure (SHA-2 family)</li>
                    <li><strong>SHA-512:</strong> Strong security (SHA-2 family)</li>
                </ul>
                <p><small>For password hashing, use specialized algorithms like bcrypt or Argon2</small></p>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
    // Hash generation functions
    function generateMD5(text) {
        // Simple MD5 implementation (for demonstration)
        // Note: This is a basic implementation. For production, use a proper library.
        function md5cycle(x, k) {
            let a = x[0], b = x[1], c = x[2], d = x[3];
            
            a = ff(a, b, c, d, k[0], 7, -680876936);
            d = ff(d, a, b, c, k[1], 12, -389564586);
            c = ff(c, d, a, b, k[2], 17, 606105819);
            b = ff(b, c, d, a, k[3], 22, -1044525330);
            a = ff(a, b, c, d, k[4], 7, -176418897);
            d = ff(d, a, b, c, k[5], 12, 1200080426);
            c = ff(c, d, a, b, k[6], 17, -1473231341);
            b = ff(b, c, d, a, k[7], 22, -45705983);
            a = ff(a, b, c, d, k[8], 7, 1770035416);
            d = ff(d, a, b, c, k[9], 12, -1958414417);
            c = ff(c, d, a, b, k[10], 17, -42063);
            b = ff(b, c, d, a, k[11], 22, -1990404162);
            a = ff(a, b, c, d, k[12], 7, 1804603682);
            d = ff(d, a, b, c, k[13], 12, -40341101);
            c = ff(c, d, a, b, k[14], 17, -1502002290);
            b = ff(b, c, d, a, k[15], 22, 1236535329);
            
            a = gg(a, b, c, d, k[1], 5, -165796510);
            d = gg(d, a, b, c, k[6], 9, -1069501632);
            c = gg(c, d, a, b, k[11], 14, 643717713);
            b = gg(b, c, d, a, k[0], 20, -373897302);
            a = gg(a, b, c, d, k[5], 5, -701558691);
            d = gg(d, a, b, c, k[10], 9, 38016083);
            c = gg(c, d, a, b, k[15], 14, -660478335);
            b = gg(b, c, d, a, k[4], 20, -405537848);
            a = gg(a, b, c, d, k[9], 5, 568446438);
            d = gg(d, a, b, c, k[14], 9, -1019803690);
            c = gg(c, d, a, b, k[3], 14, -187363961);
            b = gg(b, c, d, a, k[8], 20, 1163531501);
            a = gg(a, b, c, d, k[13], 5, -1444681467);
            d = gg(d, a, b, c, k[2], 9, -51403784);
            c = gg(c, d, a, b, k[7], 14, 1735328473);
            b = gg(b, c, d, a, k[12], 20, -1926607734);
            
            a = hh(a, b, c, d, k[5], 4, -378558);
            d = hh(d, a, b, c, k[8], 11, -2022574463);
            c = hh(c, d, a, b, k[11], 16, 1839030562);
            b = hh(b, c, d, a, k[14], 23, -35309556);
            a = hh(a, b, c, d, k[1], 4, -1530992060);
            d = hh(d, a, b, c, k[4], 11, 1272893353);
            c = hh(c, d, a, b, k[7], 16, -155497632);
            b = hh(b, c, d, a, k[10], 23, -1094730640);
            a = hh(a, b, c, d, k[13], 4, 681279174);
            d = hh(d, a, b, c, k[0], 11, -358537222);
            c = hh(c, d, a, b, k[3], 16, -722521979);
            b = hh(b, c, d, a, k[6], 23, 76029189);
            a = hh(a, b, c, d, k[9], 4, -640364487);
            d = hh(d, a, b, c, k[12], 11, -421815835);
            c = hh(c, d, a, b, k[15], 16, 530742520);
            b = hh(b, c, d, a, k[2], 23, -995338651);
            
            a = ii(a, b, c, d, k[0], 6, -198630844);
            d = ii(d, a, b, c, k[7], 10, 1126891415);
            c = ii(c, d, a, b, k[14], 15, -1416354905);
            b = ii(b, c, d, a, k[5], 21, -57434055);
            a = ii(a, b, c, d, k[12], 6, 1700485571);
            d = ii(d, a, b, c, k[3], 10, -1894986606);
            c = ii(c, d, a, b, k[10], 15, -1051523);
            b = ii(b, c, d, a, k[1], 21, -2054922799);
            a = ii(a, b, c, d, k[8], 6, 1873313359);
            d = ii(d, a, b, c, k[15], 10, -30611744);
            c = ii(c, d, a, b, k[6], 15, -1560198380);
            b = ii(b, c, d, a, k[13], 21, 1309151649);
            a = ii(a, b, c, d, k[4], 6, -145523070);
            d = ii(d, a, b, c, k[11], 10, -1120210379);
            c = ii(c, d, a, b, k[2], 15, 718787259);
            b = ii(b, c, d, a, k[9], 21, -343485551);
            
            x[0] = add32(a, x[0]);
            x[1] = add32(b, x[1]);
            x[2] = add32(c, x[2]);
            x[3] = add32(d, x[3]);
        }
        
        function cmn(q, a, b, x, s, t) {
            a = add32(add32(a, q), add32(x, t));
            return add32((a << s) | (a >>> (32 - s)), b);
        }
        
        function ff(a, b, c, d, x, s, t) {
            return cmn((b & c) | ((~b) & d), a, b, x, s, t);
        }
        
        function gg(a, b, c, d, x, s, t) {
            return cmn((b & d) | (c & (~d)), a, b, x, s, t);
        }
        
        function hh(a, b, c, d, x, s, t) {
            return cmn(b ^ c ^ d, a, b, x, s, t);
        }
        
        function ii(a, b, c, d, x, s, t) {
            return cmn(c ^ (b | (~d)), a, b, x, s, t);
        }
        
        function add32(a, b) {
            return (a + b) & 0xFFFFFFFF;
        }
        
        function md51(s) {
            let n = s.length,
                state = [1732584193, -271733879, -1732584194, 271733878],
                i;
            for (i = 64; i <= s.length; i += 64) {
                md5cycle(state, md5blk(s.substring(i - 64, i)));
            }
            s = s.substring(i - 64);
            let tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
            for (i = 0; i < s.length; i++)
                tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);
            tail[i >> 2] |= 0x80 << ((i % 4) << 3);
            if (i > 55) {
                md5cycle(state, tail);
                for (i = 0; i < 16; i++) tail[i] = 0;
            }
            tail[14] = n * 8;
            md5cycle(state, tail);
            return state;
        }
        
        function md5blk(s) {
            let md5blks = [],
                i;
            for (i = 0; i < 64; i += 4) {
                md5blks[i >> 2] = s.charCodeAt(i) +
                    (s.charCodeAt(i + 1) << 8) +
                    (s.charCodeAt(i + 2) << 16) +
                    (s.charCodeAt(i + 3) << 24);
            }
            return md5blks;
        }
        
        function rhex(n) {
            let s = "",
                j;
            for (j = 0; j < 4; j++)
                s += hex_chr[(n >> (j * 8 + 4)) & 0x0F] +
                    hex_chr[(n >> (j * 8)) & 0x0F];
            return s;
        }
        
        function hex(x) {
            for (let i = 0; i < x.length; i++)
                x[i] = rhex(x[i]);
            return x.join("");
        }
        
        let hex_chr = "0123456789abcdef".split("");
        return hex(md51(text));
    }

    function generateSHA1(text) {
        // Simple SHA-1 implementation
        function rotate_left(n, s) {
            return (n << s) | (n >>> (32 - s));
        }
        
        function lsb_hex(val) {
            let str = "";
            for (let i = 0; i <= 6; i += 2) {
                str += String.fromCharCode(parseInt(val.substr(i, 2), 16));
            }
            return str;
        }
        
        function cvt_hex(val) {
            let str = "";
            for (let i = 7; i >= 0; i--) {
                str += val.charAt(i);
            }
            return str;
        }
        
        function Utf8Encode(string) {
            string = string.replace(/\r\n/g, "\n");
            let utftext = "";
            for (let n = 0; n < string.length; n++) {
                let c = string.charCodeAt(n);
                if (c < 128) {
                    utftext += String.fromCharCode(c);
                } else if ((c > 127) && (c < 2048)) {
                    utftext += String.fromCharCode((c >> 6) | 192);
                    utftext += String.fromCharCode((c & 63) | 128);
                } else {
                    utftext += String.fromCharCode((c >> 12) | 224);
                    utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                    utftext += String.fromCharCode((c & 63) | 128);
                }
            }
            return utftext;
        }
        
        let blockstart;
        let i, j;
        let W = new Array(80);
        let H0 = 0x67452301;
        let H1 = 0xEFCDAB89;
        let H2 = 0x98BADCFE;
        let H3 = 0x10325476;
        let H4 = 0xC3D2E1F0;
        let A, B, C, D, E;
        let temp;
        
        text = Utf8Encode(text);
        let str_len = text.length;
        let word_array = new Array();
        for (i = 0; i < str_len - 3; i += 4) {
            j = text.charCodeAt(i) << 24 | text.charCodeAt(i + 1) << 16 |
                text.charCodeAt(i + 2) << 8 | text.charCodeAt(i + 3);
            word_array.push(j);
        }
        
        switch (str_len % 4) {
            case 0:
                i = 0x080000000;
                break;
            case 1:
                i = text.charCodeAt(str_len - 1) << 24 | 0x0800000;
                break;
            case 2:
                i = text.charCodeAt(str_len - 2) << 24 | text.charCodeAt(str_len - 1) << 16 | 0x08000;
                break;
            case 3:
                i = text.charCodeAt(str_len - 3) << 24 | text.charCodeAt(str_len - 2) << 16 | text.charCodeAt(str_len - 1) << 8 | 0x80;
                break;
        }
        word_array.push(i);
        
        while ((word_array.length % 16) != 14) word_array.push(0);
        word_array.push(str_len >>> 29);
        word_array.push((str_len << 3) & 0x0ffffffff);
        
        for (blockstart = 0; blockstart < word_array.length; blockstart += 16) {
            for (i = 0; i < 16; i++) W[i] = word_array[blockstart + i];
            for (i = 16; i <= 79; i++) W[i] = rotate_left(W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16], 1);
            
            A = H0;
            B = H1;
            C = H2;
            D = H3;
            E = H4;
            
            for (i = 0; i <= 19; i++) {
                temp = (rotate_left(A, 5) + ((B & C) | (~B & D)) + E + W[i] + 0x5A827999) & 0x0ffffffff;
                E = D;
                D = C;
                C = rotate_left(B, 30);
                B = A;
                A = temp;
            }
            
            for (i = 20; i <= 39; i++) {
                temp = (rotate_left(A, 5) + (B ^ C ^ D) + E + W[i] + 0x6ED9EBA1) & 0x0ffffffff;
                E = D;
                D = C;
                C = rotate_left(B, 30);
                B = A;
                A = temp;
            }
            
            for (i = 40; i <= 59; i++) {
                temp = (rotate_left(A, 5) + ((B & C) | (B & D) | (C & D)) + E + W[i] + 0x8F1BBCDC) & 0x0ffffffff;
                E = D;
                D = C;
                C = rotate_left(B, 30);
                B = A;
                A = temp;
            }
            
            for (i = 60; i <= 79; i++) {
                temp = (rotate_left(A, 5) + (B ^ C ^ D) + E + W[i] + 0xCA62C1D6) & 0x0ffffffff;
                E = D;
                D = C;
                C = rotate_left(B, 30);
                B = A;
                A = temp;
            }
            
            H0 = (H0 + A) & 0x0ffffffff;
            H1 = (H1 + B) & 0x0ffffffff;
            H2 = (H2 + C) & 0x0ffffffff;
            H3 = (H3 + D) & 0x0ffffffff;
            H4 = (H4 + E) & 0x0ffffffff;
        }
        
        let temp_val = cvt_hex(H0.toString(16)) + cvt_hex(H1.toString(16)) + 
                      cvt_hex(H2.toString(16)) + cvt_hex(H3.toString(16)) + 
                      cvt_hex(H4.toString(16));
        
        return temp_val.toLowerCase();
    }

    // For SHA-256 and SHA-512, we'll use the Web Crypto API which is more secure and efficient
    async function generateSHA256(text) {
        const encoder = new TextEncoder();
        const data = encoder.encode(text);
        const hashBuffer = await crypto.subtle.digest('SHA-256', data);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    }

    async function generateSHA512(text) {
        const encoder = new TextEncoder();
        const data = encoder.encode(text);
        const hashBuffer = await crypto.subtle.digest('SHA-512', data);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    }

    // Event listeners
    document.getElementById('inputText').addEventListener('input', async function(e) {
        const text = e.target.value;
        const resultsDiv = document.getElementById('hashResults');
        
        if (text.length === 0) {
            resultsDiv.style.display = 'none';
            return;
        }
        
        resultsDiv.style.display = 'block';
        
        // Generate all hashes
        document.getElementById('md5-value').textContent = generateMD5(text);
        document.getElementById('sha1-value').textContent = generateSHA1(text);
        document.getElementById('sha256-value').textContent = await generateSHA256(text);
        document.getElementById('sha512-value').textContent = await generateSHA512(text);
    });

    // Algorithm selector
    document.querySelectorAll('.algorithm-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            document.querySelectorAll('.algorithm-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            // Show only selected algorithm
            const algorithm = this.dataset.algorithm;
            document.querySelectorAll('.hash-result').forEach(result => {
                result.style.display = 'none';
            });
            document.getElementById(algorithm + '-result').style.display = 'block';
        });
    });

    // Copy buttons
    document.querySelectorAll('.copy-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const target = this.dataset.target;
            const text = document.getElementById(target).textContent;
            navigator.clipboard.writeText(text).then(() => {
                const originalText = this.textContent;
                this.textContent = 'Copied!';
                setTimeout(() => {
                    this.textContent = originalText;
                }, 2000);
            });
        });
    });
</script>
{% endblock %}